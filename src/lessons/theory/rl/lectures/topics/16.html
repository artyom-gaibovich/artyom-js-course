<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="../../../css/page.css">
		<link rel="stylesheet" type="text/css" href="../../../css/katex.css">
		<title></title>
	</head>
	<body>
		<div class="page">
			<div class="sidebar">
				<a id="nextPage">
					<img src="../../../css/icons/forward.svg" title="Далее">
				</a>
				<a id="prevPage">
					<img src="../../../css/icons/backward.svg" title="Назад">
				</a>
				<a href="index.html">
					<img src="../../../css/icons/submenu.svg" title="Подменю">
				</a>
				<a href="../../../index.html">
					<img src="../../../css/icons/menu.svg" title="Главное меню">
				</a>
				<a href="https://t.me/quessentry">
					<img src="../../../css/icons/tg.svg" class="icon" title="Связь со мной">
				</a>
			</div>
			<div class="elements">
				<div class="topic">
					<div class="num">
						<p>16</p>
					</div>
					<div class="title">
						<p>Формула Байеса. Сопряженное априорное распределение. Примеры</p>
					</div>
				</div>
				<div class="content">
					<p class="redline">Формула Байеса позволяет обновлять вероятности гипотез на основе новых данных:</p>
					<p class="equation">$P(\theta \mid D) = \dfrac{P(D \mid \theta) \cdot P(\theta)}{P(D)}$,</p>
					<p>где</p>
					<ul>
						<li>$\theta$ — параметр (гипотеза);</li>
						<li>$D$ — данные (наблюдения);</li>
						<li>$P(\theta)$ — априорное распределение (вероятность гипотезы до наблюдения данных);</li>
						<li>$P(D \mid \theta)$ — правдоподобие (вероятность данных при условии гипотезы);</li>
						<li>$P(\theta \mid D)$ — апостериорное распределение (вероятность гипотезы после наблюдения данных);</li>
						<li>$P(D)$ — маргинальная вероятность данных (нормировочная константа), которая вычисляется как:
							<p class="equation">$P(D) = \int P(D \mid \theta) \cdot P(\theta) \mathrm{d}\theta$.</p>
						</li>
					</ul>
					<p>Проще:</p>
					<p class="equation">$\text{Новая уверенность} = \dfrac{\text{Насколько данные правдоподобны} \times \text{Cтарая уверенность}}{\text{Общая вероятность данных}}$,</p>
					<p>где:</p>
					<ul>
						<li>cтарая уверенность (априорная вероятность) — это то, во что мы верили до получения данных;</li>
						<li>правдоподобие — насколько вероятны данные, если наша гипотеза верна;</li>
						<li>новая уверенность (апостериорная вероятность) — это то, во что мы верим после получения данных;</li>
						<li>общая вероятность данных — это просто нормализация, чтобы всё сложилось в правильную вероятность.</li>
					</ul>
					<p class="sign">Сопряженное априорное распределение</p>
					<p>Сопряженное априорное распределение — это такое распределение, которое при умножении на правдоподобие дает апостериорное распределение, принадлежащее тому же семейству распределений, что и априорное.</p>
					<p class="sign">Подходы для расчета апостериорного распределения</p>
					<ol class="roman">
						<li><b>Аналитический</b>: если априорное распределение и правдоподобие выбраны так, что апостериорное распределение принадлежит тому же семейству распределений, что и априорное, то апостериорное распределение может быть вычислено аналитически. Это возможно благодаря использованию сопряженных априорных распределений.</li>
						<li><b>Численные методы</b>:
							<ul>
								<li>Марковские цепи Монте-Карло (MCMC): алгоритм Метрополиса-Гастингса, позволяющий генерировать выборки из апостериорного распределения;</li>
								<li>Вариационный вывод: апостериорное распределение аппроксимируется более простым распределением, параметры которого оптимизируются для минимизации расстояния (например, KL-дивергенции) между истинным апостериорным распределением и аппроксимацией.</li>
							</ul>
						</li>
					</ol>
					<p class="sign">Примеры сопряженных априорных распределений:</p>
					<ol class="roman">
						<li>Биномиальное правдоподобие:
							<ul>
								<li>априорное: бета-распределение $\text{Beta}(\alpha, \beta)$</li>
								<li>апостериорное: $\text{Beta}(\alpha + k, \beta + n - k)$, где $k$ — число успехов, а $n$ — число испытаний.</li>
							</ul>
						</li>
						<li>Нормальное правдоподобие (с известной дисперсией):
							<ul>
								<li>априорное: нормальное распределение $\mathcal{N}(\mu_0, \sigma^2_0)$;</li>
								<li>апостериорное: $\mathcal{N}\bigg(\dfrac{\sigma^2\mu_0 + \sigma^2_0\overline{x}}{\sigma^2 + \sigma^2_0}; \dfrac{\sigma^2\sigma^2_0}{\sigma^2 + \sigma^2_0}\bigg)$, где $\overline{x}$ — среднее выборки, $\sigma^2$ — дисперсия выборки.</li>
							</ul>
						</li>
						<li>Пуассоновское правдоподобие
							<ul>
								<li>априорное: Гамма-распределение $\text{Gamma}(\alpha, \beta)$;</li>
								<li>апостериорное: $\text{Gamma}(\alpha + \sum x_i, \beta + n)$, где $x_i$ — наблюдения, а $n$ — их количество.</li>
							</ul>
						</li>
					</ol>
					<p class="sign">Примеры</p>
					<ol class="roman"> 
						<li>
							<p><b>Пример с биномиальным правдоподобием</b></p>
							<p>Пусть мы проводим эксперимент с $n=10$ испытаниями и наблюдаем $k=7$ успехов. Априорное распределение для вероятности успеха $p$ — $\text{Beta}(2,2)$. Тогда апостериорное распределение будет: $P(p \mid D) = \text{Beta}(2 + 7, 2 + 10 - 7) = \text{Beta}(9, 5)$.</p>
						</li>
						<li>
							<p><b>Пример с нормальным правдоподобием</b></p>
							<p>Пусть данные $D$ — это выборка из нормального распределения с известной дисперсией $\sigma^2 = 1$ и средним $\mu$. Априорное распределение для $\mu$ — $\mathcal{N}(0,1)$. После наблюдения данных $\overline{x} = 1.5$ и $n=10$ апостериорное распределение будет:</p>
							<p class="equation">$P(\mu \mid D) = \mathcal{N}\bigg(\dfrac{1 \cdot 0 + 1 \cdot 1.5}{1 + 1}; \dfrac{1 \cdot 1}{1 + 1}\bigg) = \mathcal{N}(0.75; 0.5)$.</p>
						</li>
					</ol>
				</div>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="../../../js/katex.js"></script>
	<script type="text/javascript" src="../../../js/contrib/auto-render.js"></script>
	<script type="text/javascript" src="../../../js/render.js"></script>
	<script type="text/javascript" src="../../../js/display.js"></script>
	<script type="text/javascript" src="../../../js/navigate.js"></script>
</html>